<script src="/simpletest.js"></script>

<script>

// Requirements
    // It should take two arguments. First: Should be an integer. Second: Should be an integer representing the number of decimals wanted the integer to be converted to.
    // It should NOT use multiplication or exponential notation.


// Cases to be tested
    // "1.005" ==> "101"
    // "0.615" ==>  "0.62"
    // "10.235" ==> "10.24"

function ToFixedFromString(integer, decimalNotation) {

    // First step, move the '.' 2 decimal points to the right.
    integer = integer.replace(/([^\w])(\d{2}(?=\d))/g, '$2$1');
    
    // Second step, check if the number to the right of the '.' is >= 5
    // and the number to the left is < 9.
    if (integer.match(/([0-8]?(?=[^\w]))([^\w]?)([5-9]?)([0-9]+)$/g)) {
        
        var increaseByOne = function(integer) {
            function increaseMatch(match, p1, p2, p3, p4, offset, string) {
                p1 = (Number(p1) + 1) + '';
                p4 = (Number(p4) - Number(p4)) + '';
                
                if(p4 === '0') {
                    return p1 + p2 + p3;
                } else {
                    return p1 + p2 + p3 + p4;
                };
            };
            return integer = integer.replace(/([0-8]?(?=[^\\w]))([^\\w]?)([5-9]?)([0-9]+)$/g, increaseMatch);
        }

        integer = increaseByOne(integer);

        var moveDecimal = function(integer, decimalNotation) {

            var lastIndexInteger = integer.length - 1
            var positionDecimal = lastIndexInteger - decimalNotation; 

            var fourDigToLeft = new RegExp(/(\d)(\d)(\d)(\d)([^\w]?(?!\d))/, 'g');
            var threeDigToLeft = new RegExp(/(\d)(\d)(\d)([^\w]?(?!\d))/, 'g');

            if(integer.length === 4){
                regExp = threeDigToLeft;
            } else {
                regExp = fourDigToLeft;
            }
            
            function dynamicPosition(match, string){
                var replacerStr = '';

                for(var i = 0; i < match.length - 1; i++) {
                    if (i !== positionDecimal) {
                    replacerStr = replacerStr + ('$' + ((i + 1)));

                    } else if(i === positionDecimal) {

                        if(match[i] !== '.') {
                            var newP = ('$' + ((i + 1)));
                            var newP2 = '$' + integer.length
                            replacerStr = replacerStr + newP2 + newP;
                        };
                    };
                };
                return replacerStr;
            };
            var returnedStr = integer.replace(regExp, dynamicPosition);
            return integer = integer.replace(regExp, returnedStr);
        }

        integer = moveDecimal(integer, decimalNotation);
        return integer;
    } else {
        // add solution for numbers ending in 9, to the left of the '.'
    };  
};

    tests({
        'It should round floated integers and add the decimalNotation to the rounded integers': function() {
            let integer = '1.005'
            let test1 = ToFixedFromString(integer, 2);
            eq(test1, '1.01')
            let integerB = '0.615'
            let test1b = ToFixedFromString(integerB, 2);
            eq(test1b, '0.62')
            let integerC = '10.235'
            let test1C = ToFixedFromString(integerC, 2);
            eq(test1C, '10.24')
        }
    })
</script>